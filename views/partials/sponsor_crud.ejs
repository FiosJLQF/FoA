<div class="col-9 bodylayout1col2-datamgmt" id="scholarshipsearchresultscolumn">
    <span class="bodylayout1col2title" id="sponsorInstructions">
      <label class="data-mgmt-col-title">
        Add the information for the new Sponsor below, and click "Add Sponsor".
      </label></span><br>
    <hr class="bodycol2break">
    <label class="data-mgmt-instruction">&nbsp;&nbsp;&nbsp;<span style="color: red;">*</span> indicates a required entry</label><br><br>

    <!-- The data entry form container -->
    <form form action="/switchboard/sponsoradd" method="POST" id="sponsorData">

      <!-- Sponsor Name -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorName" class="data-mgmt">Sponsor Name:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorName" name="sponsorName" class="data-mgmt-text"><br>
            <span class="data-mgmt-error" id="sponsorNameErrors"></span>
          </div>
        </div>
      </div><br>

      <!-- Sponsor Description -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorDescription" class="data-mgmt">Description:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <textarea id="sponsorDescription" name="sponsorDescription" class="data-mgmt"></textarea><br>
            <span class="data-mgmt-error" id="sponsorDescriptionErrors"></span>
          </div>
        </div>
      </div><br>

      <!-- Sponsor Website -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorWebsite" class="data-mgmt">Website:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required"></label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorWebsite" name="sponsorWebsite" class="data-mgmt-text">
          </div>
        </div>
      </div><br>

      <!-- Sponsor Logo -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorLogo" class="data-mgmt">Logo:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorLogo" name="sponsorLogo" class="data-mgmt-text"><br>
            <span class="data-mgmt-error" id="sponsorLogoErrors"></span>
          </div>
        </div>
      </div><br>

      <!-- Sponsor Contact First Name -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorContactFName" class="data-mgmt">Contact First Name:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorContactFName" name="sponsorContactFName" class="data-mgmt-text-short"><br>
            <span class="data-mgmt-error" id="sponsorContactFNameErrors"></span>
          </div>
        </div>
      </div><br>

      <!-- Sponsor Contact Last Name -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorContactLName" class="data-mgmt">Contact Last Name:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorContactLName" name="sponsorContactLName" class="data-mgmt-text-short"><br>
            <span class="data-mgmt-error" id="sponsorContactLNameErrors"></span>
          </div>
        </div>
      </div><br>

      <!-- Sponsor Contact Email -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorContactEmail" class="data-mgmt">Contact Email:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorContactEmail" name="sponsorContactEmail" class="data-mgmt-text-short"><br>
            <span class="data-mgmt-error" id="sponsorContactEmailErrors"></span>
          </div>
        </div>
      </div><br>

      <!-- Sponsor Contact Telephone -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorContactTelephone" class="data-mgmt">Contact Telephone:</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required"></label>
          </div>
          <div class="col-8 data-mgmt-value">
            <input type="text" id="sponsorContactTelephone" name="sponsorContactTelephone" class="data-mgmt-text-short">
          </div>
        </div>
      </div><br>

      <!-- Sponsor Type(s) -->
      <div class="flexcontainer-datamgmt">
        <div class="row">
          <div class="col-3 data-mgmt-label">
            <label for="sponsorType" class="data-mgmt">Sponsor Type(s):</label><br>
            <label class="data-mgmt-instruction">&nbsp;&nbsp;&nbsp;(Press [ctrl] to select multiples.)</label>
          </div>
          <div class="col-1 data-mgmt-required">
            <label for="sponsorType" class="data-mgmt-required">*</label>
          </div>
          <div class="col-8 data-mgmt-value">
            <select id="sponsorTypes" name="sponsorTypes" class="data-mgmt-multiple" multiple></select><br>
            <span class="data-mgmt-error" id="sponsorTypesErrors"></span>
          </div>
        </div>
      </div><br>

      <button class="data-mgmt" onclick="return validateData();">Add Sponsor</button>

    </form><br>
</div>

<script>

  // Set the browser tab name (i.e., title)
  document.title = "Future of Aviation - Add Sponsor";

  // Load the Sponsor Types into the DDL
  var sptRows = <%- JSON.stringify(sponsorTypeCategoriesDDL.rows) %>;
  loadSelectOptionsList("sponsorTypes", "(Not Selected)", 0, sptRows);

  //////////////////////////////////////////////////////////////////////
  // Validate the data before submitting the form
  //////////////////////////////////////////////////////////////////////
  function validateData() {
    var dataAreValid = true;  // test for errors below

    //////////////////////////////////////////////////
    // Sponsor Name
    //////////////////////////////////////////////////
    var sponsorName = document.getElementById("sponsorName").value;
    var sponsorNameErrors = document.getElementById("sponsorNameErrors");
    sponsorNameErrors.innerText = '';  // reset value
    if ( sponsorName.length === 0 ) {
      sponsorNameErrors.innerText = "Sponsor Name cannot be blank.";
    };
    if ( sponsorNameErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorNameErrors.style.display = "none";
    } else {
      sponsorNameErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // Sponsor Description
    //////////////////////////////////////////////////
    var sponsorDescription = document.getElementById("sponsorDescription").value;
    var sponsorDescriptionErrors = document.getElementById("sponsorDescriptionErrors");
    sponsorDescriptionErrors.innerText = '';  // reset value
    if ( sponsorDescription.length === 0 ) {
      sponsorDescriptionErrors.innerText = "Sponsor Description cannot be blank.";
    };
    if ( sponsorDescriptionErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorDescriptionErrors.style.display = "none";
    } else {
      sponsorDescriptionErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // Sponsor Logo
    //////////////////////////////////////////////////
    var sponsorLogo = document.getElementById("sponsorLogo").value;
    var sponsorLogoErrors = document.getElementById("sponsorLogoErrors");
    sponsorLogoErrors.innerText = '';  // reset value
    if ( sponsorLogo.length === 0 ) {
      sponsorLogoErrors.innerText = "Sponsor Logo cannot be blank.";
    };
    if ( sponsorLogoErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorLogoErrors.style.display = "none";
    } else {
      sponsorLogoErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // Sponsor Contact First Name
    //////////////////////////////////////////////////
    var sponsorContactFName = document.getElementById("sponsorContactFName").value;
    var sponsorContactFNameErrors = document.getElementById("sponsorContactFNameErrors");
    sponsorContactFNameErrors.innerText = '';  // reset value
    if ( sponsorContactFName.length === 0 ) {
      sponsorContactFNameErrors.innerText = "Sponsor Contact First Name cannot be blank.";
    };
    if ( sponsorContactFNameErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorContactFNameErrors.style.display = "none";
    } else {
      sponsorContactFNameErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // Sponsor Contact Last Name
    //////////////////////////////////////////////////
    var sponsorContactLName = document.getElementById("sponsorContactLName").value;
    var sponsorContactLNameErrors = document.getElementById("sponsorContactLNameErrors");
    sponsorContactLNameErrors.innerText = '';  // reset value
    if ( sponsorContactLName.length === 0 ) {
      sponsorContactLNameErrors.innerText = "Sponsor Contact Last Name cannot be blank.";
    };
    if ( sponsorContactLNameErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorContactLNameErrors.style.display = "none";
    } else {
      sponsorContactLNameErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // Sponsor Contact Email
    //////////////////////////////////////////////////
    var sponsorContactEmail = document.getElementById("sponsorContactEmail").value;
    var sponsorContactEmailErrors = document.getElementById("sponsorContactEmailErrors");
    sponsorContactEmailErrors.innerText = '';  // reset value
    // Email cannot be blank
    if ( sponsorContactEmail.length === 0 ) {
      sponsorContactEmailErrors.innerText += "Sponsor Contact Email cannot be blank. ";
    } else
      // Email must be properly formatted
      if ( !/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/.test(sponsorContactEmail) ) {
        sponsorContactEmailErrors.innerText += "Sponsor Contact Email must be a proper email address. ";
      };
    // Were errors found?
    if ( sponsorContactEmailErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorContactEmailErrors.style.display = "none";
    } else {
      sponsorContactEmailErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // Sponsor Types
    //////////////////////////////////////////////////
    var sponsorTypes = Array.from(document.getElementById("sponsorTypes").selectedOptions).map(v=>v.value);
    var sponsorTypesFormatted = convertOptionsToDelimitedString(sponsorTypes, "|", "0");
//    alert(sponsorTypesFormatted);
    var sponsorTypesErrors = document.getElementById("sponsorTypesErrors");
    sponsorTypesErrors.innerText = '';  // reset value
    if ( sponsorTypesFormatted === '||' ) {
      sponsorTypesErrors.innerText = "At least one Sponsor Type must be selected.";
    };
    if ( sponsorTypesErrors.innerText.length === 0 ) {  // if no errors, add the sponsor
      sponsorTypesErrors.style.display = "none";
    } else {
      sponsorTypesErrors.style.display = "block";
      dataAreValid = false;
    };

    //////////////////////////////////////////////////
    // If no errors, add the Sponsor
    //////////////////////////////////////////////////
    return dataAreValid;

  }

</script>